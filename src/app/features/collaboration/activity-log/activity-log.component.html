<div class="activity-log">
  @if (isLoading()) {
    <div class="loading-state">
      <mat-spinner diameter="28"></mat-spinner>
      <span>Loading activity...</span>
    </div>
  } @else if (hasLoadError()) {
    <div class="error-state" role="alert">
      <mat-icon>error_outline</mat-icon>
      <span>Couldnâ€™t load activity right now.</span>
      <button type="button" mat-stroked-button color="warn" (click)="onRetryLoad()">Retry</button>
    </div>
  } @else {
    @if (activities().length === 0) {
      <div class="empty-state">
        <mat-icon>history</mat-icon>
        <span>No activity yet</span>
      </div>
    } @else {
      <div class="feed" role="feed" aria-label="Task activity log">
        @for (activity of activities(); track activity.id) {
          <app-activity-item [activity]="activity"></app-activity-item>
        }
      </div>

      @if (hasMore()) {
        <div class="load-more-row">
          <button type="button" mat-stroked-button (click)="onLoadMore()" [disabled]="isLoadingMore()">
            <mat-icon>expand_more</mat-icon>
            <span>Load More</span>
          </button>
          @if (isLoadingMore()) {
            <mat-spinner diameter="18"></mat-spinner>
          }
        </div>

        @if (hasLoadMoreError()) {
          <div class="load-more-error" role="alert">
            <span>Failed to load more activity.</span>
            <button type="button" mat-button color="warn" (click)="onRetryLoadMore()">Retry</button>
          </div>
        }
      }
    }
  }
</div>
