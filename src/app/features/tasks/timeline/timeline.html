<div class="timeline-container">
  <!-- Header -->
  <div class="timeline-header">
    <h1>Task Timeline</h1>
    
    <!-- View Mode Controls -->
    <div class="view-controls">
      <mat-button-toggle-group
        [value]="viewMode()"
        (change)="changeViewMode($event.value)"
        aria-label="Timeline granularity"
      >
        <mat-button-toggle
          value="day"
          [class.view-toggle-active]="viewMode() === 'day'"
          aria-label="Day view"
        >
          <mat-icon>today</mat-icon>
          Day
        </mat-button-toggle>
        <mat-button-toggle
          value="week"
          [class.view-toggle-active]="viewMode() === 'week'"
          aria-label="Week view"
        >
          <mat-icon>view_week</mat-icon>
          Week
        </mat-button-toggle>
        <mat-button-toggle
          value="month"
          [class.view-toggle-active]="viewMode() === 'month'"
          aria-label="Month view"
        >
          <mat-icon>calendar_month</mat-icon>
          Month
        </mat-button-toggle>
      </mat-button-toggle-group>
    </div>
  </div>

  <!-- Loading Bar -->
  @if (isLoading()) {
    <mat-progress-bar mode="indeterminate"></mat-progress-bar>
  }

  <!-- Loading State -->
  @if (isLoading() && tasks().length === 0) {
    <div class="loading-container">
      <mat-spinner></mat-spinner>
      <p>Loading timeline...</p>
    </div>
  }

  <!-- Empty State -->
  @if (!isLoading() && tasks().length === 0) {
    <app-timeline-empty-state
      [noDueDateCount]="noDueDateCount()"
      [invalidDueDateCount]="invalidDueDateCount()"
      (ctaClick)="onAddDueDateCta()"
    ></app-timeline-empty-state>
  }

  <!-- Timeline Chart Container -->
  @if (!isLoading() && tasks().length > 0) {
    <div class="timeline-wrapper">
      <div #timelineContainer class="timeline-chart"></div>
    </div>
  }
</div>
