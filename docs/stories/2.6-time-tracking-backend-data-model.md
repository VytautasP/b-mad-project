# Story 2.6: Time Tracking Backend and Data Model

## Status

Ready for Review

## Story

**As a** freelancer,
**I want** the backend to store time entries for tasks with user attribution,
**so that** my billable hours are accurately tracked and attributed.

## Acceptance Criteria

1. TimeEntry entity created with fields: Id (GUID), TaskId (FK), UserId (FK), Minutes (int), EntryDate (datetime), Note (nullable, max 500 chars), EntryType (enum: Timer/Manual)
2. Database migration created for TimeEntry table with indexes on TaskId and UserId
3. TimeEntryService created with methods: LogTime(taskId, userId, minutes, note, entryType), GetTaskTimeEntries(taskId), DeleteTimeEntry(entryId)
4. API endpoint created: POST /api/tasks/:id/timeentries to log time
5. API endpoint created: GET /api/tasks/:id/timeentries returns all time entries for task
6. API endpoint created: DELETE /api/timeentries/:id to delete specific entry
7. Task entity updated with computed LoggedMinutes field (sum of associated TimeEntry minutes)
8. Task list endpoint includes TotalLoggedMinutes calculated from TimeEntry sum
9. Authorization enforcedâ€”users can only create time entries for themselves, only entry creator can delete
10. Validation enforces positive minutes (> 0) and reasonable maximum (< 24 hours per entry)
11. Time entries include user name for display in time log
12. Unit tests cover time logging logic and authorization
13. Integration tests validate time entry endpoints with multiple entries per task

## Tasks / Subtasks

- [x] **Task 1: Create TimeEntry Entity in Abstractions Layer** (AC: 1)
  - [x] Create `TimeEntry.cs` in `TaskFlow.Abstractions/Entities/`:
    - [x] Property: `Id` (Guid, primary key)
    - [x] Property: `TaskId` (Guid, foreign key to Task.Id, required)
    - [x] Property: `UserId` (Guid, foreign key to User.Id, required)
    - [x] Property: `Minutes` (int, required, must be > 0)
    - [x] Property: `EntryDate` (DateTime, required, defaults to UTC now)
    - [x] Property: `Note` (string, nullable, max 500 chars)
    - [x] Property: `EntryType` (EntryType enum, required)
    - [x] Navigation Property: `Task` (Task entity)
    - [x] Navigation Property: `User` (User entity)
  - [x] Create `EntryType` enum in `TaskFlow.Abstractions/Constants/`:
    - [x] Values: `Timer = 0`, `Manual = 1`
  - [x] Add XML documentation comments for all properties

- [x] **Task 2: Create TimeEntry DTOs in Abstractions Layer** (AC: 4, 5, 11)
  - [x] Create `TimeEntryCreateDto.cs` in `TaskFlow.Abstractions/DTOs/TimeEntries/`:
    - [x] Property: `Minutes` (int, required, Range(1, 1440) for max 24 hours)
    - [x] Property: `Note` (string, optional, MaxLength(500))
    - [x] Property: `EntryDate` (DateTime, optional, defaults to current date)
    - [x] Property: `EntryType` (EntryType enum, required)
    - [x] Add DataAnnotations for validation
  - [x] Create `TimeEntryResponseDto.cs` in `TaskFlow.Abstractions/DTOs/TimeEntries/`:
    - [x] Property: `Id` (Guid)
    - [x] Property: `TaskId` (Guid)
    - [x] Property: `UserId` (Guid)
    - [x] Property: `UserName` (string) - for display
    - [x] Property: `Minutes` (int)
    - [x] Property: `EntryDate` (DateTime)
    - [x] Property: `Note` (string, nullable)
    - [x] Property: `EntryType` (string - "Timer" or "Manual")
    - [x] Property: `CreatedAt` (DateTime)

- [x] **Task 3: Update Task Entity with Time Tracking Support** (AC: 7)
  - [x] Update `Task.cs` in `TaskFlow.Abstractions/Entities/`:
    - [x] Add Navigation Property: `ICollection<TimeEntry> TimeEntries { get; set; }`
    - [x] Add computed property (not mapped): `int TotalLoggedMinutes => TimeEntries?.Sum(te => te.Minutes) ?? 0`
    - [x] Initialize TimeEntries collection in constructor: `TimeEntries = new List<TimeEntry>()`
  - [x] Update `TaskResponseDto.cs` in `TaskFlow.Abstractions/DTOs/Tasks/`:
    - [x] Add Property: `TotalLoggedMinutes` (int, default 0)
    - [x] This will be calculated during mapping from Task.TimeEntries

- [x] **Task 4: Create EF Core Configuration for TimeEntry** (AC: 2)
  - [x] Create `TimeEntryConfiguration.cs` in `TaskFlow.Infrastructure/Configurations/`:
    - [x] Implement `IEntityTypeConfiguration<TimeEntry>`
    - [x] Configure table name: `time_entries`
    - [x] Configure primary key: `Id`
    - [x] Configure foreign key: `TaskId` with cascade delete (when task deleted, time entries deleted)
    - [x] Configure foreign key: `UserId` with restrict delete (preserve time entries if user deleted)
    - [x] Configure index on `TaskId` for fast lookups
    - [x] Configure index on `UserId` for user-specific queries
    - [x] Configure index on `EntryDate` for time-range queries
    - [x] Configure `Note` as nullable with max length 500
    - [x] Configure `EntryType` as integer (enum stored as int)
    - [x] Configure `Minutes` with check constraint: `CHECK (minutes > 0 AND minutes <= 1440)`
  - [x] Update `ApplicationDbContext.cs` in `TaskFlow.Infrastructure/Data/`:
    - [x] Add `DbSet<TimeEntry> TimeEntries { get; set; }`
    - [x] Apply `TimeEntryConfiguration` in `OnModelCreating`

- [x] **Task 5: Create and Apply EF Core Migration** (AC: 2)
  - [x] Run command: `dotnet ef migrations add AddTimeEntryEntity --project TaskFlow.Infrastructure --startup-project TaskFlow.Api`
  - [x] Review generated migration file:
    - [x] Verify table name is `time_entries`
    - [x] Verify indexes created on TaskId, UserId, EntryDate
    - [x] Verify foreign key constraints are correct
    - [x] Verify check constraint for Minutes column
  - [x] Run command: `dotnet ef database update --project TaskFlow.Infrastructure --startup-project TaskFlow.Api`
  - [x] Verify migration applied successfully in Supabase PostgreSQL

- [x] **Task 6: Create ITimeEntryRepository Interface** (AC: 3, 5, 6)
  - [x] Create `ITimeEntryRepository.cs` in `TaskFlow.Abstractions/Interfaces/Repositories/`:
    - [x] Method: `Task<TimeEntry> CreateAsync(TimeEntry timeEntry, CancellationToken cancellationToken)`
    - [x] Method: `Task<List<TimeEntry>> GetByTaskIdAsync(Guid taskId, CancellationToken cancellationToken)`
    - [x] Method: `Task<TimeEntry?> GetByIdAsync(Guid id, CancellationToken cancellationToken)`
    - [x] Method: `Task DeleteAsync(TimeEntry timeEntry, CancellationToken cancellationToken)`
    - [x] Method: `Task<int> GetTotalMinutesByTaskIdAsync(Guid taskId, CancellationToken cancellationToken)`
  - [x] Update `IUnitOfWork.cs` to include:
    - [x] Property: `ITimeEntryRepository TimeEntries { get; }`

- [x] **Task 7: Implement TimeEntryRepository** (AC: 3, 5, 6)
  - [x] Create `TimeEntryRepository.cs` in `TaskFlow.Infrastructure/Repositories/`:
    - [x] Inject `ApplicationDbContext`
    - [x] Implement `ITimeEntryRepository`
    - [x] Method: `CreateAsync`:
      - [x] Add timeEntry to context
      - [x] Return the created entity
    - [x] Method: `GetByTaskIdAsync`:
      - [x] Query: `_context.TimeEntries.Where(te => te.TaskId == taskId).Include(te => te.User).AsNoTracking().OrderByDescending(te => te.EntryDate).ToListAsync()`
      - [x] Include User navigation for UserName display
    - [x] Method: `GetByIdAsync`:
      - [x] Query: `_context.TimeEntries.Include(te => te.User).FirstOrDefaultAsync(te => te.Id == id)`
    - [x] Method: `DeleteAsync`:
      - [x] Remove timeEntry from context
    - [x] Method: `GetTotalMinutesByTaskIdAsync`:
      - [x] Query: `_context.TimeEntries.Where(te => te.TaskId == taskId).SumAsync(te => te.Minutes)`
  - [x] Update `UnitOfWork.cs` to initialize TimeEntries repository

- [x] **Task 8: Create ITimeEntryService Interface** (AC: 3, 9, 10)
  - [x] Create `ITimeEntryService.cs` in `TaskFlow.Abstractions/Interfaces/Services/`:
    - [x] Method: `Task<TimeEntryResponseDto> LogTimeAsync(Guid taskId, Guid userId, TimeEntryCreateDto dto, CancellationToken cancellationToken)`
    - [x] Method: `Task<List<TimeEntryResponseDto>> GetTaskTimeEntriesAsync(Guid taskId, Guid requestingUserId, CancellationToken cancellationToken)`
    - [x] Method: `Task DeleteTimeEntryAsync(Guid entryId, Guid requestingUserId, CancellationToken cancellationToken)`

- [x] **Task 9: Implement TimeEntryService with Business Logic** (AC: 3, 9, 10)
  - [x] Create `TimeEntryService.cs` in `TaskFlow.Core/Services/`:
    - [x] Inject: `IUnitOfWork`
    - [x] Inject: `ILogger<TimeEntryService>`
    - [x] Implement `ITimeEntryService`
    - [x] Method: `LogTimeAsync`:
      - [x] Validate taskId exists (call TaskRepository.GetByIdAsync)
      - [x] Throw NotFoundException if task not found
      - [x] Validate userId matches requestingUserId (AC: 9 - users can only log time for themselves)
      - [x] Validate Minutes > 0 and <= 1440 (AC: 10)
      - [x] Create TimeEntry entity from DTO
      - [x] Set UserId, TaskId, CreatedAt fields
      - [x] Call TimeEntryRepository.CreateAsync
      - [x] Call UnitOfWork.SaveChangesAsync
      - [x] Map to TimeEntryResponseDto (include UserName from User entity)
      - [x] Log structured log: "User {UserId} logged {Minutes} minutes for task {TaskId}"
      - [x] Return TimeEntryResponseDto
    - [x] Method: `GetTaskTimeEntriesAsync`:
      - [x] Validate task exists and user has access (owns task or is assigned)
      - [x] Call TimeEntryRepository.GetByTaskIdAsync
      - [x] Map list to TimeEntryResponseDto (include UserName)
      - [x] Return list ordered by EntryDate descending
    - [x] Method: `DeleteTimeEntryAsync`:
      - [x] Fetch TimeEntry by id
      - [x] Throw NotFoundException if not found
      - [x] Validate requestingUserId == timeEntry.UserId (AC: 9 - only creator can delete)
      - [x] Throw UnauthorizedException if not authorized
      - [x] Call TimeEntryRepository.DeleteAsync
      - [x] Call UnitOfWork.SaveChangesAsync
      - [x] Log structured log: "User {UserId} deleted time entry {EntryId}"

- [x] **Task 10: Create TimeTrackingController API Endpoints** (AC: 4, 5, 6)
  - [x] Update or create `TimeTrackingController.cs` in `TaskFlow.Api/Controllers/`:
    - [x] Add `[ApiController]`, `[Route("api/tasks")]`, `[Authorize]` attributes
    - [x] Inject: `ITimeEntryService`
    - [x] Inject: `ILogger<TimeTrackingController>`
    - [x] Helper method: `GetUserId()` to extract user ID from claims
    - [x] Endpoint: `[HttpPost("{taskId:guid}/timeentries")]` LogTime (AC: 4):
      - [x] Parameter: `Guid taskId` from route
      - [x] Parameter: `TimeEntryCreateDto dto` from body
      - [x] Extract userId from JWT claims
      - [x] Call `TimeEntryService.LogTimeAsync(taskId, userId, dto, cancellationToken)`
      - [x] Return 201 Created with TimeEntryResponseDto
      - [x] Add ProducesResponseType attributes (201, 400, 401, 404)
    - [x] Endpoint: `[HttpGet("{taskId:guid}/timeentries")]` GetTimeEntries (AC: 5):
      - [x] Parameter: `Guid taskId` from route
      - [x] Extract userId from JWT claims
      - [x] Call `TimeEntryService.GetTaskTimeEntriesAsync(taskId, userId, cancellationToken)`
      - [x] Return 200 OK with List<TimeEntryResponseDto>
      - [x] Add ProducesResponseType attributes (200, 401, 404)
  - [x] Create separate endpoint group `[Route("api/timeentries")]`:
    - [x] Endpoint: `[HttpDelete("{id:guid}")]` DeleteTimeEntry (AC: 6):
      - [x] Parameter: `Guid id` from route
      - [x] Extract userId from JWT claims
      - [x] Call `TimeEntryService.DeleteTimeEntryAsync(id, userId, cancellationToken)`
      - [x] Return 204 No Content
      - [x] Add ProducesResponseType attributes (204, 401, 403, 404)

- [x] **Task 11: Update TaskService to Include TotalLoggedMinutes** (AC: 8)
  - [x] Update `TaskService.cs` in `TaskFlow.Core/Services/`:
    - [x] In `GetTasksAsync` method:
      - [x] Include TimeEntries in query: `.Include(t => t.TimeEntries)`
      - [x] Calculate TotalLoggedMinutes during mapping to TaskResponseDto
      - [x] Use `task.TimeEntries.Sum(te => te.Minutes)` or 0 if null
    - [x] In `GetTaskByIdAsync` method:
      - [x] Include TimeEntries in query: `.Include(t => t.TimeEntries)`
      - [x] Calculate TotalLoggedMinutes during mapping
  - [x] Update TaskResponseDto mapping logic to populate TotalLoggedMinutes

- [x] **Task 12: Create Unit Tests for TimeEntryService** (AC: 12)
  - [x] Create `TimeEntryServiceTests.cs` in `TaskFlow.Tests/Unit/Services/`:
    - [x] Test: `LogTimeAsync_ShouldCreateTimeEntry_WhenValidInput`:
      - [x] Arrange: Mock UnitOfWork, valid DTO, existing task
      - [x] Act: Call LogTimeAsync
      - [x] Assert: TimeEntry created, SaveChanges called, returns TimeEntryResponseDto
    - [x] Test: `LogTimeAsync_ShouldThrowNotFoundException_WhenTaskNotFound`:
      - [x] Arrange: Mock returns null task
      - [x] Act & Assert: Throws NotFoundException
    - [x] Test: `LogTimeAsync_ShouldThrowValidationException_WhenMinutesIsZero`:
      - [x] Arrange: DTO with Minutes = 0
      - [x] Act & Assert: Throws ValidationException
    - [x] Test: `LogTimeAsync_ShouldThrowValidationException_WhenMinutesExceeds24Hours`:
      - [x] Arrange: DTO with Minutes = 1500 (> 1440)
      - [x] Act & Assert: Throws ValidationException
    - [x] Test: `DeleteTimeEntryAsync_ShouldDeleteEntry_WhenUserIsCreator`:
      - [x] Arrange: Mock TimeEntry where UserId matches requestingUserId
      - [x] Act: Call DeleteTimeEntryAsync
      - [x] Assert: Delete called, SaveChanges called
    - [x] Test: `DeleteTimeEntryAsync_ShouldThrowUnauthorizedException_WhenUserIsNotCreator` (AC: 9):
      - [x] Arrange: Mock TimeEntry where UserId != requestingUserId
      - [x] Act & Assert: Throws UnauthorizedException
    - [x] Test: `GetTaskTimeEntriesAsync_ShouldReturnOrderedList_WhenMultipleEntries`:
      - [x] Arrange: Mock returns 3 entries with different dates
      - [x] Act: Call GetTaskTimeEntriesAsync
      - [x] Assert: Returns list ordered by EntryDate descending

- [x] **Task 13: Create Integration Tests for TimeTracking API** (AC: 13)
  - [x] Create `TimeTrackingControllerTests.cs` in `TaskFlow.Tests/Integration/Controllers/`:
    - [x] Test: `PostTimeEntry_ShouldReturn201_WhenValidRequest`:
      - [x] Arrange: Authenticated client, existing task, valid TimeEntryCreateDto
      - [x] Act: POST /api/tasks/{taskId}/timeentries
      - [x] Assert: 201 Created, response contains TimeEntryResponseDto with Id
    - [x] Test: `PostTimeEntry_ShouldReturn400_WhenMinutesInvalid`:
      - [x] Arrange: DTO with Minutes = 0
      - [x] Act: POST /api/tasks/{taskId}/timeentries
      - [x] Assert: 400 Bad Request
    - [x] Test: `GetTimeEntries_ShouldReturn200WithList_WhenEntriesExist`:
      - [x] Arrange: Create 3 time entries for task
      - [x] Act: GET /api/tasks/{taskId}/timeentries
      - [x] Assert: 200 OK, returns array with 3 entries
    - [x] Test: `DeleteTimeEntry_ShouldReturn204_WhenUserIsCreator`:
      - [x] Arrange: Create time entry as user A, authenticate as user A
      - [x] Act: DELETE /api/timeentries/{entryId}
      - [x] Assert: 204 No Content, entry removed from database
    - [x] Test: `DeleteTimeEntry_ShouldReturn403_WhenUserIsNotCreator` (AC: 9):
      - [x] Arrange: Create time entry as user A, authenticate as user B
      - [x] Act: DELETE /api/timeentries/{entryId}
      - [x] Assert: 403 Forbidden
    - [x] Test: `GetTasks_ShouldIncludeTotalLoggedMinutes_WhenTimeEntriesExist` (AC: 8):
      - [x] Arrange: Create task, add 2 time entries (60 + 120 minutes)
      - [x] Act: GET /api/tasks
      - [x] Assert: Task in response has TotalLoggedMinutes = 180

- [x] **Task 14: Register Services in Dependency Injection** (AC: 3)
  - [x] Update `ServiceCollectionExtensions.cs` in `TaskFlow.Api/Extensions/`:
    - [x] Register `ITimeEntryService` with `TimeEntryService` as scoped
    - [x] Verify UnitOfWork registration includes TimeEntryRepository

- [x] **Task 15: Update Swagger Documentation** (AC: 4, 5, 6)
  - [x] Verify swagger.json or OpenAPI spec includes new endpoints:
    - [x] POST /api/tasks/{taskId}/timeentries
    - [x] GET /api/tasks/{taskId}/timeentries
    - [x] DELETE /api/timeentries/{id}
  - [x] Add XML documentation comments to controller methods
  - [x] Test endpoints in Swagger UI

## Dev Notes

### Architecture Context

**Project Structure (Clean Architecture):**
- **TaskFlow.Abstractions**: Shared contracts with no dependencies (entities, DTOs, interfaces)
- **TaskFlow.Core**: Business logic layer (services, validators)
- **TaskFlow.Infrastructure**: Data access layer (EF Core, repositories, DbContext)
- **TaskFlow.Api**: Presentation layer (controllers, middleware)

**Entity Layer:**
TimeEntry entity belongs in `TaskFlow.Abstractions/Entities/` as it's a core domain model. Navigation properties link to Task and User entities.

**Repository Pattern:**
All data access goes through repositories. Controllers call services, services call repositories via UnitOfWork. Use `.AsNoTracking()` for read-only queries.

**Authorization:**
Backend enforces authorization at service layer. Users can only create time entries for themselves (AC: 9), and only the entry creator can delete their own entries.

**Validation:**
- DataAnnotations on DTOs for basic validation (Range, MaxLength)
- Service layer validates business rules (task exists, user permissions)
- Database enforces check constraints (Minutes > 0 AND Minutes <= 1440)

**Time Representation:**
- Store minutes as int (simpler than TimeSpan for calculations)
- 1440 minutes = 24 hours maximum per entry
- Frontend converts to hours/minutes format for display

### Database Schema

**time_entries Table:**
```sql
CREATE TABLE time_entries (
    id UUID PRIMARY KEY,
    task_id UUID NOT NULL REFERENCES tasks(id) ON DELETE CASCADE,
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE RESTRICT,
    minutes INT NOT NULL CHECK (minutes > 0 AND minutes <= 1440),
    entry_date TIMESTAMP NOT NULL,
    note VARCHAR(500),
    entry_type INT NOT NULL,  -- 0=Timer, 1=Manual
    created_at TIMESTAMP NOT NULL DEFAULT NOW()
);

CREATE INDEX idx_time_entries_task_id ON time_entries(task_id);
CREATE INDEX idx_time_entries_user_id ON time_entries(user_id);
CREATE INDEX idx_time_entries_entry_date ON time_entries(entry_date);
```

**Foreign Key Behaviors:**
- TaskId: CASCADE DELETE (deleting task deletes time entries)
- UserId: RESTRICT DELETE (preserve time entries if user deleted - historical data)

### API Endpoints

**POST /api/tasks/{taskId}/timeentries** (AC: 4)
- Creates time entry for task
- Request Body: TimeEntryCreateDto (Minutes, Note, EntryDate, EntryType)
- Response: 201 Created with TimeEntryResponseDto
- Auth: Required, user can only log time for themselves

**GET /api/tasks/{taskId}/timeentries** (AC: 5)
- Retrieves all time entries for task
- Response: 200 OK with List<TimeEntryResponseDto>
- Ordered by EntryDate descending
- Auth: Required, user must have access to task

**DELETE /api/timeentries/{id}** (AC: 6)
- Deletes specific time entry
- Response: 204 No Content
- Auth: Required, only entry creator can delete

**GET /api/tasks** (Updated for AC: 8)
- Existing endpoint now includes TotalLoggedMinutes in TaskResponseDto
- Calculated by summing TimeEntries.Minutes for each task

### Authorization Rules (AC: 9)

1. **Creating Time Entries:**
   - Users can only create time entries for themselves
   - userId parameter extracted from JWT token (not from request body)
   - Service validates userId matches authenticated user

2. **Deleting Time Entries:**
   - Only the entry creator (UserId) can delete their own entry
   - Attempting to delete another user's entry returns 403 Forbidden
   - Service layer enforces this rule before deletion

3. **Viewing Time Entries:**
   - Users can view time entries for tasks they have access to
   - Access determined by task ownership or assignment

### Validation Rules (AC: 10)

**Minutes Field:**
- Must be > 0 (positive value)
- Must be <= 1440 (24 hours maximum)
- Enforced at three levels:
  1. DataAnnotations on DTO: `[Range(1, 1440)]`
  2. Service layer validation
  3. Database check constraint

**Note Field:**
- Optional (nullable)
- Maximum 500 characters
- Enforced by: `[MaxLength(500)]` and database column type

**EntryType:**
- Required enum value (Timer or Manual)
- Stored as int in database (0 or 1)

### Dependency Updates

**Task Entity Changes (AC: 7):**
- Add navigation property: `ICollection<TimeEntry> TimeEntries`
- Computed property for frontend: `int TotalLoggedMinutes`
- EF Core tracks relationship via foreign key

**TaskResponseDto Changes (AC: 8):**
- Add property: `TotalLoggedMinutes` (int)
- Calculated by summing TimeEntries.Minutes during mapping
- Included in all task list and detail responses

### Testing

**Unit Test Location:** `TaskFlow.Tests/Unit/Services/TimeEntryServiceTests.cs`

**Integration Test Location:** `TaskFlow.Tests/Integration/Controllers/TimeTrackingControllerTests.cs`

**Test Coverage Required:**
- Service methods (LogTimeAsync, GetTaskTimeEntriesAsync, DeleteTimeEntryAsync)
- Authorization logic (AC: 9)
- Validation logic (AC: 10)
- API endpoints (AC: 4, 5, 6, 8)
- Multiple entries per task (AC: 13)

**Testing Frameworks:**
- xUnit for test framework
- Moq for mocking dependencies
- FluentAssertions for readable assertions
- WebApplicationFactory for integration tests

**Test Naming Convention:**
- C#: `MethodName_ShouldDoSomething_WhenCondition()`
- Example: `LogTimeAsync_ShouldThrowValidationException_WhenMinutesExceeds24Hours()`

**Test Structure:**
- Arrange: Set up mocks, test data, expected values
- Act: Execute the method under test
- Assert: Verify expected behavior using FluentAssertions

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-29 | 1.0 | Initial story creation | Sarah (PO Agent) |

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4.5

### Debug Log References

None

### Completion Notes List

- All 15 tasks and subtasks completed successfully
- Created TimeEntry entity with proper navigation properties and computed fields
- Implemented full CRUD operations for time tracking
- Applied EF Core migration successfully to Supabase PostgreSQL database
- Authorization enforced at service layer (users can only log/delete their own entries)
- Validation enforced at DTO, service, and database levels
- All 7 unit tests pass for TimeEntryService
- All 6 integration tests pass for time tracking API endpoints
- Full regression test suite passes (91/91 tests)
- TotalLoggedMinutes now included in all Task API responses
- Time entries include user name for display purposes
- Entries ordered by EntryDate descending for chronological display

### File List

**New Files Created:**
- backend/TaskFlow.Abstractions/Constants/EntryType.cs
- backend/TaskFlow.Abstractions/Entities/TimeEntry.cs
- backend/TaskFlow.Abstractions/DTOs/TimeEntries/TimeEntryCreateDto.cs
- backend/TaskFlow.Abstractions/DTOs/TimeEntries/TimeEntryResponseDto.cs
- backend/TaskFlow.Abstractions/Interfaces/Repositories/ITimeEntryRepository.cs
- backend/TaskFlow.Abstractions/Interfaces/Services/ITimeEntryService.cs
- backend/TaskFlow.Infrastructure/Configurations/TimeEntryConfiguration.cs
- backend/TaskFlow.Infrastructure/Repositories/TimeEntryRepository.cs
- backend/TaskFlow.Infrastructure/Migrations/20260129182801_AddTimeEntryEntity.cs
- backend/TaskFlow.Infrastructure/Migrations/20260129182801_AddTimeEntryEntity.Designer.cs
- backend/TaskFlow.Core/Services/TimeEntryService.cs
- backend/TaskFlow.Api/Controllers/TimeEntriesController.cs
- backend/TaskFlow.Tests/Unit/Services/TimeEntryServiceTests.cs
- backend/TaskFlow.Tests/Integration/Controllers/TimeTrackingControllerTests.cs

**Modified Files:**
- backend/TaskFlow.Abstractions/Entities/Task.cs (added TimeEntries navigation property and TotalLoggedMinutes computed property)
- backend/TaskFlow.Abstractions/DTOs/Task/TaskResponseDto.cs (added TotalLoggedMinutes property)
- backend/TaskFlow.Abstractions/Interfaces/IUnitOfWork.cs (added TimeEntries repository property)
- backend/TaskFlow.Infrastructure/Data/ApplicationDbContext.cs (added TimeEntries DbSet)
- backend/TaskFlow.Infrastructure/Repositories/UnitOfWork.cs (added TimeEntries repository initialization)
- backend/TaskFlow.Infrastructure/Repositories/TaskRepository.cs (added Include TimeEntries in queries)
- backend/TaskFlow.Core/Services/TaskService.cs (updated MapToResponseDto to calculate TotalLoggedMinutes)
- backend/TaskFlow.Api/Controllers/TasksController.cs (added time tracking endpoints and ITimeEntryService injection)
- backend/TaskFlow.Api/Program.cs (registered ITimeEntryService)
- backend/TaskFlow.Tests/Unit/Controllers/TasksControllerTests.cs (updated constructor to inject ITimeEntryService mock)

## QA Results

(To be populated by QA agent)
