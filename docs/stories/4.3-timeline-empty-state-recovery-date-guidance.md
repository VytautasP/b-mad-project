# Story 4.3: Timeline Empty-State Recovery and Date Guidance

## Status

Ready for Review

## Story

**As a** planner,
**I want** timeline empty states to explain next steps,
**so that** I can quickly add due dates and populate the timeline.

## Acceptance Criteria

1. Timeline empty state includes clear reason and a direct CTA to add due dates.
2. CTA navigates to relevant task date editing context and returns user to timeline.
3. Day/Week/Month selected state is visually clear and accessible.
4. Empty-state copy and CTA are present on desktop and mobile layouts.

## Tasks / Subtasks

- [x] Build timeline empty-state component.
- [x] Wire CTA to date-edit flow and return behavior.
- [x] Improve selected-state visibility for timeline granularity toggles.
- [x] Add validation for no-date and partial-date scenarios.

## Dev Notes

- Priority: P0
- Source specification: `docs/front-end-spec.md`
- Epic backlog reference: `docs/prd/4.0-ux-friendly-ui-refinement-prioritized.md`

## Dev Agent Record

### Agent Model Used

GPT-5.3-Codex

### Debug Log References

- `npx ng test --no-watch --include=src/app/features/tasks/timeline/timeline.spec.ts`
- `npm run test -- --watch=false`

### Completion Notes List

- Added a dedicated `TimelineEmptyStateComponent` with reasoned copy and a direct `Add due date` CTA.
- Wired timeline empty-state CTA to dashboard date-edit context via query params and implemented return-to-timeline flow after create completion.
- Improved Day/Week/Month selected-state visibility and accessibility affordances in timeline toggle controls.
- Added due-date coverage validation in timeline data loading for both no-date and invalid/partial-date scenarios, with empty-state messaging based on counts.
- Added focused timeline spec assertions for CTA navigation and due-date validation counters.

### File List

- `src/app/features/tasks/timeline/timeline.ts`
- `src/app/features/tasks/timeline/timeline.html`
- `src/app/features/tasks/timeline/timeline.css`
- `src/app/features/tasks/timeline/timeline.spec.ts`
- `src/app/features/tasks/timeline/timeline-empty-state/timeline-empty-state.ts`
- `src/app/features/tasks/timeline/timeline-empty-state/timeline-empty-state.html`
- `src/app/features/tasks/timeline/timeline-empty-state/timeline-empty-state.css`
- `src/app/features/dashboard/dashboard.ts`
- `src/app/features/tasks/task-form/task-form.component.ts`
- `src/app/features/tasks/task-form/task-form.component.html`

### Change Log

- 2026-02-22: Implemented Story 4.3 timeline empty-state recovery flow, date-guidance CTA navigation/return, toggle selected-state clarity improvements, and no-date/partial-date validation handling.

### DoD Checklist Summary

- Requirements/ACs: ✅ Met for story scope.
- Coding standards/project structure: ✅ Met.
- Testing: ⚠️ Targeted timeline test command runs but current workspace test setup reports pre-existing Jasmine/Vitest incompatibility in existing spec style.
- Build/lint: ✅ Changed files report no compile/template errors via workspace diagnostics.
- Story administration: ✅ Completed and updated.
